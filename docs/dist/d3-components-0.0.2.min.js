/*! D3 Components v0.0.2 | (c) 2017 Zan Pan | MIT license */
d3.components={},d3.defaultOptions={id:"chart",renderer:"svg",responsive:!0,width:300,aspectRatio:.618034,color:"#1f77b4",colorScheme:d3.schemeCategory10,stroke:"none",strokeWidth:1,fontSize:14,lineHeight:20,title:{show:!1,x:"50%",y:"1.6em",height:"2em",wrapText:!0,wrapWidth:"90%",lineHeight:"2em",fontSize:"1.4em",fontWeight:"bold",textAnchor:"middle",text:""},tooltip:{show:!0,autoplay:!1,carousel:{delay:2e3,interval:2e3},html:function(t,e){return"Datum "+e},style:{display:"none",boxSizing:"border-box",position:"absolute",pointerEvents:"none",padding:"0.2em 0.6em",backgroundColor:"#fff",border:"1px solid #999",borderRadius:"0.2em",fontSize:"85%",opacity:.8}},legend:{autoplay:!1,carousel:{delay:2e3,interval:2e3},symbol:{width:"1.294427em",height:"0.8em"},dx:"0.5em",transform:"scale(0.85)",lineHeight:"1.6em",textColor:"#333",disabledTextColor:"#ccc"}},d3.parseData=function(t,e){var a=d3.components[t],r=a.schema||{},n=r.hierarchy;if(Array.isArray(e)){if(e=e.filter(function(t){return null!==t&&void 0!==t}).map(function(e,a){return Array.isArray(e)?(e=e.map(function(t){return t.hasOwnProperty("series")||(t.series=String(a)),t}),d3.parseData(t,e)):"object"!==d3.type(e)?{index:String(a),value:e}:e}),"object"===r.type){var i=r.entries;e=e.map(function(e){var a=Object.keys(e);return i.forEach(function(r){var i=r.key,o=r.type,s=null;if(e.hasOwnProperty(i))i===n&&"array"===o&&(e[n]=d3.parseData(t,e[n])),a.splice(a.indexOf(i),1),s=i;else{var l=r.mappings||[];l.some(function(t){var e=a.indexOf(t);return e!==-1&&(a.splice(e,1),s=t,!0)}),null===s&&a.some(function(t){return d3.type(e[t])===o&&(s=t,!0)})}if(s){var d=e[s];"string"===o?d=String(d):"number"===o?d=Number(d):"date"===o&&(d=new Date(d)),e[i]=d}}),e})}return[].concat.apply([],e)}return d3.parseData(t,[e])[0]},d3.parseOptions=function(t,e){var a=d3.components[t];e=d3.extend(a,e);var r=d3.defaultOptions,n=e.id||r.id,i=d3.select("#"+n);if(r.responsive&&!e.hasOwnProperty("responsive")){if(!e.hasOwnProperty("width")){var o=parseInt(i.style("width"))||r.width;e.width=Math.round(o)}if(!e.hasOwnProperty("height")){var s=e.aspectRatio||r.aspectRatio,l=parseInt(i.style("height"))||e.width*s;e.height=Math.round(l)}e.hasOwnProperty("fontSize")||(e.fontSize=parseInt(i.style("font-size"))),e.hasOwnProperty("lineHeight")||(e.lineHeight=parseInt(i.style("line-height")))}e=d3.extend(r,e);var d=e.fontSize,c=e.lineHeight,p=d3.extend({top:c,right:2*d,bottom:2*c,left:4*d},e.margin);e.margin=p,e.innerWidth=e.width-p.left-p.right,e.innerHeight=e.height-p.top-p.bottom;var h=i.node(),u=d3.extend({id:n+"-tooltip"},e.tooltip);if(e.tooltip=u,h.style.position="relative",u.show){var f=u.id,g=u.style,m=d3.select("#"+f).node();if(null===m){m=document.createElement("div"),m.id=f,m.className="tooltip";for(var y in g)g.hasOwnProperty(y)&&(m.style[y]=g[y]);"CANVAS"===h.tagName?h.parentNode.insertBefore(m,h):h.appendChild(m)}}e.chart=h,"CANVAS"===h.tagName&&(e.renderer="canvas",i=h),"canvas"===e.renderer?("CANVAS"!==h.tagName&&(i=document.createElement("canvas"),h.appendChild(i)),i.width=e.width,i.height=e.height,e.context=i.getContext("2d")):e.context=null;for(var y in e)e.hasOwnProperty(y)&&(e[y]=d3.parseValue(e[y],e));if(e.hasOwnProperty("map")){var v=e.map||{},x=v.name||"world";e.map=d3.extend(d3.maps[x],v)}return e},d3.parseValue=function(t,e){var a=d3.type(t);if("object"===a)for(var r in t)t.hasOwnProperty(r)&&(t[r]=d3.parseValue(t[r],e));else if("string"===a)if(/^\-?\d+\.?\d*(px)$/.test(t))t=Number(t.replace("px",""));else if(/^\-?\d+\.?\d*(em)$/.test(t))e.hasOwnProperty("fontSize")&&(t=Number(t.replace("em",""))*e.fontSize);else if(/^\-?\d+\.?\d*\%$/.test(t))e.hasOwnProperty("width")&&(t=Number(t.replace("%",""))*e.width/100);else if(/^(a|de)scending\(\w+\)$/.test(t)){var n=t.split(/\W/),i=n[0],r=n[1];t=function(t,e){var a="ascdending"===i?-1:1;return t.hasOwnProperty(r)&&e.hasOwnProperty(r)?void 0===t[r]||null===t[r]?a:d3[i](t[r],e[r])||-a:t.data&&e.data?void 0==t.data[r]||null===t.data[r]?a:d3[i](t.data[r],e.data[r])||-a:0}}return t},d3.type=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},d3.extend=function(t,e){var a={};if("object"===d3.type(t))for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];"object"===d3.type(n)&&(n=d3.extend(a[r],n)),a[r]=n}if("object"===d3.type(e))for(var r in e)if(e.hasOwnProperty(r)){var n=e[r];"object"===d3.type(n)&&(n=d3.extend(a[r],n)),a[r]=n}return a},d3.translate=function(t,e){return"translate("+t+","+e+")"},d3.regularPolygon=function(t,e){var a=2*Math.PI/t;return d3.range(t).map(function(t){var r=a*t;return[e*Math.sin(r),-e*Math.cos(r)]})},d3.setAxis=function(t,e){var a=d3.axisBottom(t),r=e.orient;return"top"===r?a=d3.axisTop(t):"left"===r?a=d3.axisLeft(t):"right"===r&&(a=d3.axisRight(t)),a.ticks(e.ticks).tickSizeInner(e.tickSizeInner).tickSizeOuter(e.tickSizeOuter).tickPadding(e.tickPadding),""!==e.tickFormat?a.tickFormat(d3.format(e.tickFormat)):a.tickFormat(""),a},d3.createPlot=function(t,e){var a=e.width,r=e.height,n=d3.select(t).append("svg").attr("class",e.type).attr("width",a),i=0,o=e.title;if(o.show){var s=n.append("text").attr("class","title").attr("x",o.x).attr("y",o.y).attr("font-size",o.fontSize).attr("font-weight",o.fontWeight).attr("text-anchor",o.textAnchor).text(o.text).call(d3.wrapText,o),l=Math.ceil(s.node().getComputedTextLength()/o.wrapWidth);i=l*o.lineHeight}o.height=i;var d=d3.translate(a/2,r/2+i),c=n.attr("height",r+i).append("g").attr("class","container").attr("transform",d).attr("stroke",e.stroke).attr("stroke-width",e.strokeWidth);return{svg:n,container:c}},d3.getPosition=function(t,e){for(var a=d3.select(t).node(),r=a.getBoundingClientRect(),n=e.tagName;a.parentElement.tagName!==n;)a=a.parentElement;var i=a.parentElement.getBoundingClientRect();return{top:r.top-i.top,left:r.left-i.left,width:r.width,height:r.height}},d3.setTooltip=function(t,e){if(e.show){var a=d3.select("#"+e.id),r=parseInt(a.style("line-height")),n=e.hoverTarget,i=e.hoverEffect;n.on("mouseover",function(n,o){var s=d3.mouse(t),l=s[0],d=s[1];if(a.attr("class","tooltip").style("display","block").html(e.html(n,o)),isNaN(l)||isNaN(d)){var c=parseInt(a.style("width"))/2,p=parseInt(a.style("height"))+r/6;s=d3.getPosition(this,t),l=s.left+s.width/2-c,d=s.top+s.height/2-p}a.style("left",l+"px").style("top",d+"px"),"darker"===i&&d3.select(this).attr("fill",d3.color(n.color).darker())}).on("mousemove",function(e){var n=d3.mouse(t),i=parseInt(a.style("width"))/2,o=parseInt(a.style("height"))+r/6;a.style("left",n[0]-i+"px").style("top",n[1]-o+"px")}).on("mouseout",function(t){a.style("display","none"),"darker"===i&&d3.select(this).attr("fill",t.color)}),e.autoplay&&n.call(d3.triggerAction,d3.extend({event:"mouseover",carousel:!0},e.carousel))}},d3.setLegend=function(t,e){if(e.show){var a=e.symbol,r=Math.round(a.width),n=Math.round(a.height),i=e.textColor,o=e.disabledTextColor,s=e.lineHeight,l=t.append("g").attr("class","legend").attr("transform",e.translation).attr("cursor","pointer").selectAll(".legend-item").data(e.bindingData).enter().append("g").attr("class",function(t){return t.hasOwnProperty("disabled")||(t.disabled=t.data.disabled||!1),"legend-item"+(t.disabled?" disabled":"")}).attr("transform",e.transform);l.append("rect").attr("width",r).attr("height",n).attr("x",0).attr("y",function(t,e){return s*(e+1)-n}).attr("fill",function(t){return t.disabled?o:t.color}),l.append("text").text(e.text).attr("x",r).attr("y",function(t,e){return s*(e+1)}).attr("dx",e.dx).attr("fill",function(t){return t.disabled?o:i}),l.on("click",function(t){var a=!t.disabled,r=d3.select(this).classed("disabled",a);r.select("rect").attr("fill",a?o:t.color),r.select("text").attr("fill",a?o:i),t.disabled=a,e.onclick(t)}),e.autoplay&&l.call(d3.triggerAction,d3.extend({event:"click",carousel:!0},e.carousel))}},d3.wrapText=function(t,e){if(e.wrapText){var a=e.wrapWidth,r=e.lineHeight;t.each(function(){var t=d3.select(this),n=t.text().split(/\s+/).reverse();if(n.length>1){for(var i=t.attr("x"),o=t.attr("y"),s=(parseFloat(t.attr("dy")),t.text(null).append("tspan")),l=n.pop(),d=0,c=[];l;)c.push(l),s.text(c.join(" ")),s.node().getComputedTextLength()>a&&(c.pop(),s.text(c.join(" ")),c=[l],d+=1,s=t.append("tspan").attr("x",i).attr("dy",r).text(l)),l=n.pop();if(e.verticalAlign){var p=e.verticalAlign,h=0;"middle"===p?h=.5:"bottom"===p&&(h=1),t.attr("y",o-d*r*h)}}})}},d3.triggerAction=function(t,e){var a=e.event||e,r=e&&e.sort||null,n=t.sort(r).nodes()||[],i=null;try{i=new Event(a)}catch(t){i=document.createEvent("SVGEvents"),i.initEvent(a,!0,!0)}if("object"===d3.type(e)){var o=e.delay||0,s=n.length;if(s&&e.carousel)var l=e.interval||2e3,d=e.limit||s,c=e.randomize,p=e.infinite,h=0,u=0,f=d3.timer(function(t){t>l*u&&(u+=1,n[h].dispatchEvent(i),h=c===!0?Math.floor(Math.random()*s):(h+1)%s),p===!1&&u>=d&&f.stop()},o);else d3.timeout(function(){n.forEach(function(t){t.dispatchEvent(i)})},o)}else n.forEach(function(t){t.dispatchEvent(i)})},d3.parseGeoData=function(t,e){var a=t.data,r=t.key||"id",n=e&&e.data||[],i=[],o=[],s=d3.type(a);if("object"===s)if(a.hasOwnProperty("features"))i=a.features;else if(window.topojson&&t.object){var l=a.objects[t.object];i=topojson.feature(a,l).features,e.neighbors&&(o=topojson.neighbors(l.geometries))}return{features:i.map(function(t,e){var a=String(t[r]||t.properties[r]||e);return t.data={id:a,value:void 0},n.some(function(e){var n=String(e[r]),i=n===a;return!i&&/^\W/.test(n)&&(i=new RegExp(n).test(a)),i&&(t.data=e),i}),t}),neighbors:o}},d3.maps={world:{center:[0,0],scale:.25},china:{key:"name",center:[103.3886,35.5636],scale:1}},d3.components.barChart={type:"bar chart",schema:{type:"object",entries:[{key:"label",type:"string",mappings:["category","name"]},{key:"value",type:"number",mappings:["count","percentage"]}]},sort:null,labels:{show:!1},tooltip:{html:function(t,e){return"Datum "+e}}},d3.barChart=function(t,e){t=d3.parseData("barChart",t),e=d3.parseOptions("barChart",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=e.renderer;e.context,e.width,e.height,e.stroke,e.strokeWidth,e.colorScheme,e.fontSize,e.lineHeight;if("svg"===r){var n=d3.createPlot(a,e);n.svg,n.container}},d3.components.pieChart={type:"pie chart",schema:{type:"object",entries:[{key:"label",type:"string",mappings:["category","name"]},{key:"value",type:"number",mappings:["count","percentage"]}]},sort:null,maxRatio:.8,donutRatio:0,innerRadius:0,labels:{show:!1,dy:"0.25em",fill:"#fff",minAngle:Math.PI/10,wrapText:!1,wrapWidth:"5em",lineHeight:"1.2em",verticalAlign:"middle",text:function(t){var e=(t.endAngle-t.startAngle)/(2*Math.PI);return d3.format(".0%")(e)}},legend:{show:!0,text:function(t){return t.data.label}},tooltip:{html:function(t){var e=(t.endAngle-t.startAngle)/(2*Math.PI);return t.data.label+": "+d3.format(".1%")(e)}}},d3.pieChart=function(t,e){t=d3.parseData("pieChart",t),e=d3.parseOptions("pieChart",e);var a=d3.dispatch("init","update","finalize"),r=e.chart,n=e.renderer,i=e.context,o=e.width,s=e.height,l=e.innerWidth,d=e.innerHeight,c=e.stroke,p=e.strokeWidth,h=e.colorScheme,u=(e.fontSize,e.lineHeight,e.maxRatio),f=e.donutRatio,g=e.outerRadius||Math.min(l,d)/2,m=e.innerRadius||g*f;"number"===d3.type(m)&&"number"===d3.type(g)&&(m=Math.min(m,g*u));var y=d3.pie().sort(e.sort).value(function(t){return t.disabled?0:t.value}),v=d3.arc().innerRadius(m).outerRadius(g).context(i),x=y(t);if("svg"===n){var b=d3.createPlot(r,e),k=(b.svg,b.container);a.on("init.slices",function(t){k.selectAll(".arc").data(t).enter().append("g").attr("class","arc")}),a.on("update.arcs",function(t){var e=d3.scaleOrdinal(h);t.append("path").attr("d",v).attr("fill",function(t){return t.color=e(t.data.label),t.color})}),a.on("update.labels",function(t){var a=e.labels;a.show&&t.append("text").attr("class","label").attr("x",function(t){return v.centroid(t)[0]}).attr("y",function(t){return v.centroid(t)[1]}).attr("dy",a.dy).attr("text-anchor","middle").attr("fill",a.fill).text(a.text).attr("opacity",function(t){var e=t.endAngle-t.startAngle;return e>=a.minAngle?1:0}).call(d3.wrapText,a)}),a.on("update.tooltip",function(t){var a=e.tooltip;a.hoverTarget=t.selectAll("path"),a.hoverEffect="darker",d3.setTooltip(r,a)}),a.on("finalize.legend",function(){var r=e.legend;r.translation||(r.translation=d3.translate(-o/2,-s/2)),r.bindingData=x,r.onclick=function(e){var r=e.data.label,n=e.data.disabled;t.some(function(t){return t.label===r&&(t.disabled=!n,!0)}),k.selectAll(".arc").remove(),a.call("init",this,y(t)),a.call("update",this,k.selectAll(".arc"))},d3.setLegend(k,r)}),a.call("init",this,x),a.call("update",this,k.selectAll(".arc"))}else"canvas"===n&&(i.translate(o/2,s/2),x.forEach(function(t,e){i.beginPath(),v(t),i.fillStyle=h[e],i.fill(),i.closePath()}),"none"!==c&&(i.beginPath(),x.forEach(v),i.strokeStyle=c,i.lineWidth=p,i.stroke(),i.closePath()));a.call("finalize",this)},d3.components.lineChart={type:"line chart",schema:{type:"object",entries:[{key:"label",type:"string",mappings:["category","name"]},{key:"value",type:"number",mappings:["count","percentage"]}]},sort:null,labels:{show:!1},tooltip:{html:function(t,e){return"Datum "+e}}},d3.lineChart=function(t,e){t=d3.parseData("lineChart",t),e=d3.parseOptions("lineChart",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=e.renderer;e.context,e.width,e.height,e.stroke,e.strokeWidth,e.colorScheme,e.fontSize,e.lineHeight;if("svg"===r){var n=d3.createPlot(a,e);n.svg,n.container}},d3.components.bubbleChart={type:"bubble chart",schema:{type:"object",entries:[{key:"x",type:"number",mappings:["category","name","year"]},{key:"y",type:"number",mappings:["count"]},{key:"z",type:"number",mappings:[]}]},offsetX:[.5,.5],offsetY:[0,0],framed:!1,axisX:{orient:"bottom",ticks:8,tickSizeInner:6,tickSizeOuter:0,tickPadding:4,tickFormat:"d"},axisY:{orient:"left",ticks:6,tickSizeInner:6,tickSizeOuter:0,tickPadding:4,tickFormat:"d"},gridX:{show:!0,stroke:"#ccc",strokeDash:[6,4]},gridY:{show:!1,stroke:"#ccc",strokeDash:[6,4]},labelX:{show:!1,text:"X",dy:"2.8em"},labelY:{show:!1,text:"Y",dy:"-3em"},dots:{scale:"2%",minRadius:4,stroke:"#fff",opacity:.8,gradient:!1,hue:160,saturation:.8,lightness:.6},tooltip:{html:function(t){return"x = "+t.x+"<br/>y = "+t.y+"<br/>z = "+t.z}}},d3.bubbleChart=function(t,e){t=d3.parseData("bubbleChart",t),e=d3.parseOptions("bubbleChart",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=e.renderer,n=(e.context,e.width,e.height,e.innerWidth),i=e.innerHeight,o=e.margin,s=(e.stroke,e.strokeWidth,e.colorScheme),l=e.fontSize,d=(e.lineHeight,e.offsetX),c=e.offsetY,p=d3.extent(t,function(t){return t.x}),h=d3.extent(t,function(t){return t.y}),u=d3.extent(t,function(t){return t.z}),f=p[0],g=p[1],m=h[0],y=h[1],v=(u[0],u[1]),x=d3.scaleLinear().domain(e.domainX||[f-d[0],g+d[1]]).range(e.rangeX||[0,n]),b=d3.scaleLinear().domain(e.domainY||[m-c[0],y+c[1]]).range(e.rangeY||[i,0]);if("svg"===r){var k=d3.createPlot(a,e),w=d3.translate(o.left,o.top+e.title.height),S=(k.svg,k.container.attr("transform",w)),A=e.axisX,z=e.axisY,P=A.orient,O=z.orient,C=d3.setAxis(x,A),M=d3.setAxis(b,z);if(e.framed)S.append("g").attr("class","axis axis-x").attr("transform",d3.translate(0,i)).call(C),S.append("g").attr("class","axis axis-y").call(M),S.append("g").attr("class","axis axis-x").call(C.tickFormat("")),S.append("g").attr("class","axis axis-y").attr("transform",d3.translate(n,0)).call(M.tickFormat(""));else{var j=S.append("g").attr("class","axis axis-x").call(C),W=S.append("g").attr("class","axis axis-y").call(M);"bottom"===P&&j.attr("transform",d3.translate(0,i)),"right"===O&&W.attr("transform",d3.translate(n,0))}S.selectAll(".axis").attr("font-size",l);var T=e.gridX,D=e.gridY;T.show&&(S.append("g").attr("class","grid grid-x").attr("stroke-dasharray",T.strokeDash.join()).call(M.tickSize(-n,0).tickFormat("")),S.select(".grid-x").select(".domain").attr("stroke-width",0),S.select(".grid-x").selectAll(".tick").attr("stroke-width",function(){var t=d3.select(this).attr("transform"),e=+t.split(/[\,\(\)]/)[2];return 0===e||e===i?0:null}).select("line").attr("stroke",T.stroke)),D.show&&(S.append("g").attr("class","grid grid-y").attr("stroke-dasharray",D.strokeDash.join()).attr("transform",d3.translate(0,i)).call(C.tickSize(-i,0).tickFormat("")),S.select(".grid-y").select(".domain").attr("stroke-width",0),S.select(".grid-y").selectAll(".tick").attr("stroke-width",function(){var t=d3.select(this).attr("transform"),e=+t.split(/[\,\(\)]/)[1];return 0===e||e===n?0:null}).select("line").attr("stroke",D.stroke));var E=e.labelX,H=e.labelY;E.show&&S.append("text").attr("class","label label-x").attr("text-anchor","end").attr("x",n).attr("y",i).attr("dy",E.dy).text(E.text),H.show&&S.append("text").attr("class","label label-y").attr("text-anchor","end").attr("y",0).attr("dy",H.dy).attr("transform","rotate(-90)").text(H.text);var I=d3.scaleOrdinal(s),R=e.dots,N=R.scale,L=R.minRadius,F=R.opacity,X=R.hue,Y=R.saturation,V=R.lightness,q=S.selectAll(".dot").data(t).enter().append("circle").attr("class","dot").attr("cx",function(t){return x(t.x)}).attr("cy",function(t){return b(t.y)}).attr("r",function(t){return Math.sqrt(t.z/v)*N+L}).attr("opacity",F).attr("stroke",R.stroke).attr("fill",function(t){if("function"==typeof R.color)return R.color(t);if(R.gradient){var e=X*(1-t.y/y)+(180-X),a=Y*(t.y-m)/(y-m||1)+(1-Y),r=V-(1-V)*(t.x-f)/(g-f||1);return d3.hsl(e,a,r)}return I(t.x)}).sort(function(t,e){return e.z-t.z});R.onclick&&q.attr("cursor","pointer").on("click",function(t){"function"==typeof R.onclick&&R.onclick(t)});var B=e.tooltip;B.hoverTarget=q,d3.setTooltip(a,B)}},d3.components.radarChart={type:"radar chart",schema:{type:"object",entries:[{key:"axis",type:"string",mappings:["category","label","name"]},{key:"series",type:"string",mappings:["item","year"]},{key:"value",type:"number",mappings:["count","percentage"]}]},sort:null,curve:"curveLinearClosed",levels:3,maxValue:0,grids:{show:!0,shape:"polygon",stroke:"#ccc",strokeWidth:1,fill:"none"},rays:{show:!0,stroke:"#999",strokeWidth:1},areas:{stroke:"#1f77b4",strokeWidth:2,fill:"#3182bd",opacity:.65},dots:{show:!0,radius:3,strokeWidth:1,fill:"#fff"},labels:{show:!0,dy:"0.25em",padding:"1em",wrapText:!1,wrapWidth:"10em",lineHeight:"1.2em",verticalAlign:"middle"},legend:{show:null,text:function(t){return t.series}},tooltip:{html:function(t){return t.axis+": "+t.value}}},d3.radarChart=function(t,e){t=d3.parseData("radarChart",t),e=d3.parseOptions("radarChart",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=e.renderer,n=e.context,i=e.width,o=e.height,s=e.innerWidth,l=e.innerHeight,d=(e.stroke,e.strokeWidth,e.colorScheme),c=(e.fontSize,e.lineHeight,e.axes||[]),p=e.series||[],h=[];t.forEach(function(t){var e=t.axis,a=t.series;c.indexOf(e)===-1&&c.push(e),p.indexOf(a)===-1&&p.push(a),h.push(t.value)}),p=p.map(function(e){var a=t.filter(function(t){return t.series===e});return{series:e,disabled:!1,data:c.map(function(t){var e=null;return a.some(function(a){return a.axis===t&&(e=a,!0)}),null===e&&(e={axis:t,value:0}),e})}});var u=c.length,f=2*Math.PI/u,g=Math.min(s,l)/2,m=Math.max(d3.max(h),e.maxValue),y=d3.scaleLinear().range([0,g]).domain([0,m]),v=d3.radialLine().radius(function(t){return y(t.value)}).angle(function(t,e){return f*e}).curve(d3[e.curve]).context(n);if("svg"===r){var x=d3.createPlot(a,e),b=(x.svg,x.container),k=e.grids,w=e.levels;if(k.show){var S=k.shape;"polygon"===S?b.selectAll(".grid").data(d3.range(1,w+1)).enter().append("polygon").attr("class","grid").attr("points",function(t){var e=y(m/w*t);return d3.regularPolygon(u,e).join(" ")}).attr("stroke",k.stroke).attr("stroke-width",k.strokeWidth).attr("fill",k.fill):"circle"===S&&b.selectAll(".grid").data(d3.range(1,w+1)).enter().append("circle").attr("class","grid").attr("cx",0).attr("cy",0).attr("r",function(t){return g/w*t}).attr("stroke",k.stroke).attr("stroke-width",k.strokeWidth).attr("fill",k.fill)}var A=e.rays;A.show&&b.selectAll(".ray").data(d3.range(u)).enter().append("line").attr("class","ray").attr("x1",0).attr("y1",0).attr("x2",function(t){return g*Math.sin(f*t)}).attr("y2",function(t){return-g*Math.cos(f*t)}).attr("stroke",A.stroke).attr("stroke-width",A.strokeWidth);var z=d3.scaleOrdinal(d),P=function(t){return t.color},O=function(t){return d3.color(t.color).darker()},C=e.areas,M=e.dots,j=b.selectAll(".series").data(p).enter().append("g").attr("class","series").attr("stroke",function(t){return t.color=z(t.series),d3.color(t.color).darker()}).attr("stroke-width",C.strokeWidth).style("display",function(t){return t.disabled?"none":"block"});j.append("path").attr("class","area").attr("d",function(t){return v(t.data)}).attr("fill",P).attr("opacity",C.opacity).on("mouseover",function(){j.selectAll(".area").attr("fill","none").attr("pointer-events","none"),d3.select(this).attr("fill",O).attr("pointer-events","visible")}).on("mouseout",function(){j.selectAll(".area").attr("fill",P).attr("pointer-events","visible")});if(M.show)var W=j.selectAll(".dot").data(function(t){return t.data}).enter().append("circle").attr("class","dot").attr("cx",function(t,e){return y(t.value)*Math.sin(f*e)}).attr("cy",function(t,e){return-y(t.value)*Math.cos(f*e)}).attr("r",M.radius).attr("stroke",M.stroke).attr("stroke-width",M.strokeWidth).attr("fill",M.fill);var T=e.labels;if(T.show){var D=g+T.padding;b.selectAll(".label").data(c).enter().append("text").attr("class","label").attr("x",function(t,e){return D*Math.sin(f*e)}).attr("y",function(t,e){return-D*Math.cos(f*e)}).attr("dy",T.dy).attr("text-anchor",function(t,e){var a="middle";return e>0&&e<Math.ceil(u/2)?a="start":e>=Math.floor(u/2)+1&&(a="end"),a}).text(function(t){return t}).call(d3.wrapText,T)}var E=e.legend;null===E.show&&(E.show=p.length>1),E.translation||(E.translation=d3.translate(-i/2,-o/2)),E.bindingData=p,E.onclick=function(){j.style("display",function(t){return t.disabled?"none":"block"})},d3.setLegend(b,E);var H=e.tooltip;H.hoverTarget=W,d3.setTooltip(a,H)}},d3.components.sunburstChart={type:"sunburst chart",schema:{type:"object",hierarchy:"children",entries:[{key:"label",type:"string",mappings:["category","name"]},{key:"value",type:"number",mappings:["count"]},{key:"children",type:"array"}]},sort:null,donut:{show:!1,ratio:.2,radius:20},zoomable:!0,labels:{show:!1},tooltip:{html:function(t){return t.data.label+": "+t.data.value}},stroke:"#fff",colorScheme:d3.schemeCategory20c},d3.sunburstChart=function(t,e){t=d3.parseData("sunburstChart",t),e=d3.parseOptions("sunburstChart",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=e.renderer,n=e.context,i=e.width,o=e.height,s=(e.stroke,e.strokeWidth,e.colorScheme),l=(e.fontSize,e.lineHeight,Math.min(i,o)/2),d=d3.scaleLinear().range([0,2*Math.PI]),c=d3.scaleSqrt().range([0,l]),p=d3.hierarchy(t,function(t){return t.children}).sum(function(t){return t.children?0:t.value});"function"==typeof e.sort&&p.sort(e.sort),d3.partition()(p);var h=d3.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,d(t.x0)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,d(t.x1)))}).innerRadius(function(t){return Math.max(0,c(t.y0))}).outerRadius(function(t){return Math.max(0,c(t.y1))}).context(n);if("svg"===r){var u=d3.createPlot(a,e),f=(u.svg,u.container),g=d3.scaleOrdinal(s),m=e.donut,y=f.selectAll(".arc").data(p.descendants()).enter().append("g").attr("class","arc").append("path").attr("d",h).attr("opacity",function(t){return m.show&&null===t.parent?0:null}).attr("fill",function(t){return g((t.children?t:t.parent).data.label)});e.zoomable&&y.attr("cursor","pointer").on("click",function(t){var e=l*m.ratio||m.radius;f.transition().tween("scale",function(){var a=d3.interpolate(d.domain(),[t.x0,t.x1]),r=d3.interpolate(c.domain(),[t.y0,1]),n=d3.interpolate(c.range(),[t.y0?e:0,l]);return function(t){d.domain(a(t)),c.domain(r(t)).range(n(t))}}).selectAll("path").attrTween("d",function(t){return function(){return h(t)}})});var v=e.tooltip;v.hoverTarget=y,d3.setTooltip(a,v)}},d3.components.choroplethMap={type:"choropleth map",schema:{type:"object",entries:[{key:"id",type:"string",mappings:["adcode","code","name"]},{key:"series",type:"string",mappings:["year"]},{key:"value",type:"number",mappings:["count"]}]},levels:5,projection:"geoMercator",coloring:"ordinal",colorScale:"scaleOrdinal",graticules:{show:!1,step:[10,10],stroke:"#ccc"},tooltip:{html:function(t){return t.data.id+": "+t.data.value}},stroke:"#666",fill:"#fff",colorScheme:d3.schemeCategory20c},d3.choroplethMap=function(t,e){t=d3.parseData("choroplethMap",t),e=d3.parseOptions("choroplethMap",e);var a=(d3.dispatch("init","update","finalize"),e.chart),r=(e.id,e.renderer),n=(e.context,e.width,e.height),i=(e.stroke,e.fill),o=(e.strokeWidth,e.colorScheme),s=(e.fontSize,e.lineHeight,e.domain||[]),l=d3.extent(t,function(t){return t.value}),d=s[0]||l[0],c=s[1]||l[1],p=e.map,h=d3[e.projection]().translate([0,0]).center(p.center).scale(n*p.scale),u=d3.geoPath().projection(h),f=d3.parseGeoData(p,{neighbors:!0,data:t}),g=f.features,m=f.neighbors,y=e.coloring,v=e.colorScale,x=d3.scaleOrdinal(o);if("scaleSequential"===v)x=d3.scaleSequential(o);else if("scaleThreshold"===v){var b=e.thresholds||[];if(!b.length){var k=e.levels,w=(c-d)/k;b=d3.range(k).map(function(t){return w*t+d})}x=d3.scaleThreshold().domain(b).range(o)}if("svg"===r){var S=d3.createPlot(a,e),A=(S.svg,S.container),z=e.graticules,P=d3.geoGraticule().step(z.step);z.show&&A.append("path").datum(P).attr("class","graticule").attr("d",u).attr("stroke",z.stroke);var O=A.selectAll(".region").data(g).enter().append("path").attr("class","region").attr("d",u).attr("fill",function(t,e){return"topological"===y&&m.length?t.value=(0|d3.max(m[e],function(t){return g[t].value}))+1:t.value=t.data.value,void 0===t.value||null===t.value?i:("scaleSequential"===v&&(t.value=(t.value-d)/c),x(t.value))}),C=e.tooltip;C.hoverTarget=O,d3.setTooltip(a,C)}};